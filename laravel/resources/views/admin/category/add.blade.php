<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
    <title>添加分类</title>

	<link rel="stylesheet" href="{{asset('admin/style/css/ch-ui.admin.css')}}">
	<link rel="stylesheet" href="{{asset('admin/style/font/css/font-awesome.min.css')}}">
    <script src="{{asset('lirary/uploadify/jquery1.11.3.min.js')}}" type="text/javascript"></script>
    <script type="text/javascript" src="{{asset('js/util.js')}}"></script>


    <style>
        .result_wrap section{
            margin: 25px;
        }
        .result_wrap .title{
            margin: 5px;
        }
    </style>
</head>
<body>
    <!--面包屑导航 开始-->
    <div class="crumb_warp">
        <!--<i class="fa fa-bell"></i> 欢迎使用登陆网站后台，建站的首选工具。-->
        <i class="fa fa-home"></i> <a href="#">首页</a> &raquo; <a href="#">分类管理</a> &raquo; 添加分类
    </div>
    <!--面包屑导航 结束-->


    <div class="result_wrap">
        <form action="{{url('admin/category')}}" method="post" onsubmit="return add_category();">
            <section CLASS="clear">
                <p class="title">已有分类：</p>
                {{csrf_field()}}
                @foreach($data as $d)
                <label class="category-list">
                    <span class="label-cat">{{$d->cat_name}}</span>
                </label>
                @endforeach
            </section>
            <section>
                <p class="title">分类名称：</p>
                <input type="text" class="cat_name" name="cat_name" placeholder="输入文章分类名称">
                <input type="hidden" name="cat_pid" value="0">
                <input type="hidden" name="cat_time" value="{{time()}}">
                <span id="cat_w_info"><i class="fa fa-exclamation-circle yellow"></i>分类名称不可重复</span>
            </section>
            <section>
                <input type="submit" value="提交">
                <input type="button" class="back" onclick="history.go(-1)" value="返回">
            </section>
        </form>
    </div>
    <div>
        <div id="js_article" class="rich_media">

            <div id="js_top_ad_area" class="top_banner" style="display: none;"></div>

            <div class="rich_media_inner">

                <div id="page-content" class="rich_media_area_primary">

                    <div id="img-content">

                        <h2 class="rich_media_title" id="activity-name">
                            【第1076期】 如何无痛降低 if else 面条代码复杂度                                    </h2>
                        <div id="meta_content" class="rich_media_meta_list">
                            <em id="post-date" class="rich_media_meta rich_media_meta_text">2017-10-12</em>

                            <em class="rich_media_meta rich_media_meta_text">ewind</em>
                            <a class="rich_media_meta rich_media_meta_link rich_media_meta_nickname" href="##" id="post-user">前端早读课</a>
                            <span class="rich_media_meta rich_media_meta_text rich_media_meta_nickname">前端早读课</span>

                            <div id="js_profile_qrcode" class="profile_container" style="display:none;">
                                <div class="profile_inner">
                                    <strong class="profile_nickname">前端早读课</strong>
                                    <img class="profile_avatar" id="js_profile_qrcode_img" src="" alt="">

                                    <p class="profile_meta">
                                        <label class="profile_meta_label">微信号</label>
                                        <span class="profile_meta_value">FeZaoDuKe</span>
                                    </p>

                                    <p class="profile_meta">
                                        <label class="profile_meta_label">功能介绍</label>
                                        <span class="profile_meta_value">关注前端，产品体验设计，更关注前端同行的成长。 每天清晨五点早读，五万+同行相伴成长。</span>
                                    </p>

                                </div>
                                <span class="profile_arrow_wrp" id="js_profile_arrow_wrp">
                            <i class="profile_arrow arrow_out"></i>
                            <i class="profile_arrow arrow_in"></i>
                        </span>
                            </div>
                        </div>







                        <div class="rich_media_content " id="js_content">






                            <p style="box-sizing: border-box;margin: 0px 0px 1.125em;color: rgb(32, 33, 35);">前言</p><p style="box-sizing: border-box;margin: 0px 0px 1.125em;color: rgb(32, 33, 35);">今日早读文章由美团点评 @ewind 授权分享。</p><p style="box-sizing: border-box;margin: 0px 0px 1.125em;color: rgb(32, 33, 35);">正文从这开始～</p><p style="box-sizing: border-box;margin: 0px 0px 1.125em;color: rgb(32, 33, 35);">相信不少同学在维护老项目时，都遇到过在深深的 if else 之间纠缠的业务逻辑。面对这样的一团乱麻，简单粗暴地继续增量修改常常只会让复杂度越来越高，可读性越来越差，有没有固定的套路来梳理它呢？这里分享三种简单通用的重构方式。</p><p style="box-sizing: border-box;margin: 0px 0px 1.125em;color: rgb(32, 33, 35);"><span style="color: rgb(61, 167, 66);"><strong>什么是面条代码</strong></span></p><p style="box-sizing: border-box;margin: 0px 0px 1.125em;color: rgb(32, 33, 35);">所谓的【面条代码】，常见于对复杂业务流程的处理中。它一般会满足这么几个特点：</p><ul style="list-style-type: disc;" class="list-paddingleft-2"><li><p style="box-sizing: border-box;margin: 0px 0px 1.125em;color: rgb(32, 33, 35);">内容长</p></li><li><p style="box-sizing: border-box;margin: 0px 0px 1.125em;color: rgb(32, 33, 35);">结构乱</p></li><li><p style="box-sizing: border-box;margin: 0px 0px 1.125em;color: rgb(32, 33, 35);">嵌套深</p></li></ul><p style="box-sizing: border-box;margin: 0px 0px 1.125em;color: rgb(32, 33, 35);">我们知道，主流的编程语言均有函数或方法来组织代码。对于面条代码，不妨认为它就是满足这几个特征的函数吧。根据语言语义的区别，可以将它区分为两种基本类型：</p><p style="box-sizing: border-box;margin: 0px 0px 1.125em;color: rgb(32, 33, 35);"><span style="color: rgb(61, 167, 66);"><strong>if...if 型</strong></span></p><p style="box-sizing: border-box;margin: 0px 0px 1.125em;color: rgb(32, 33, 35);">这种类型的代码结构形如：</p><pre class="" style="box-sizing: border-box;margin: 0px 0px 1.125em;font-size: 0.875rem;overflow: auto;color: white;background: rgb(20, 20, 20) none repeat scroll 0% 0%;padding: 10px;"><p><span class="" style="box-sizing: border-box;z-index: 1;color: rgb(249, 238, 154);">function</span> demo <span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">(</span>a<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">,</span> b<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">,</span> c<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">)</span> <span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">{</span><br style="box-sizing: border-box;"> &nbsp;<span class="" style="box-sizing: border-box;z-index: 1;color: rgb(249, 238, 154);">if</span> <span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">(</span><span class="" style="box-sizing: border-box;z-index: 1;">f</span><span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">(</span>a<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">,</span> b<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">,</span> c<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">)</span><span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">)</span> <span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">{</span><br style="box-sizing: border-box;"> &nbsp; &nbsp;<span class="" style="box-sizing: border-box;z-index: 1;color: rgb(249, 238, 154);">if</span> <span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">(</span><span class="" style="box-sizing: border-box;z-index: 1;">g</span><span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">(</span>a<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">,</span> b<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">,</span> c<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">)</span><span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">)</span> <span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">{</span><br style="box-sizing: border-box;"> &nbsp; &nbsp; &nbsp;<span class="" spellcheck="true" style="box-sizing: border-box;z-index: 1;color: rgb(120, 120, 120);">// ...</span><br style="box-sizing: border-box;"> &nbsp; &nbsp;<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">}</span><br style="box-sizing: border-box;"> &nbsp; &nbsp;<span class="" spellcheck="true" style="box-sizing: border-box;z-index: 1;color: rgb(120, 120, 120);">// ...</span><br style="box-sizing: border-box;"> &nbsp; &nbsp;<span class="" style="box-sizing: border-box;z-index: 1;color: rgb(249, 238, 154);">if</span> <span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">(</span><span class="" style="box-sizing: border-box;z-index: 1;">h</span><span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">(</span>a<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">,</span> b<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">,</span> c<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">)</span><span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">)</span> <span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">{</span><br style="box-sizing: border-box;"> &nbsp; &nbsp; &nbsp;<span class="" spellcheck="true" style="box-sizing: border-box;z-index: 1;color: rgb(120, 120, 120);">// ...</span><br style="box-sizing: border-box;"> &nbsp; &nbsp;<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">}</span><br style="box-sizing: border-box;"> &nbsp;<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">}</span><br style="box-sizing: border-box;"> &nbsp;<span class="" style="box-sizing: border-box;z-index: 1;color: rgb(249, 238, 154);">if</span> <span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">(</span><span class="" style="box-sizing: border-box;z-index: 1;">j</span><span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">(</span>a<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">,</span> b<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">,</span> c<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">)</span><span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">)</span> <span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">{</span><br style="box-sizing: border-box;"> &nbsp; &nbsp;<span class="" spellcheck="true" style="box-sizing: border-box;z-index: 1;color: rgb(120, 120, 120);">// ...</span><br style="box-sizing: border-box;"> &nbsp;<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">}</span><br style="box-sizing: border-box;"> &nbsp;<span class="" style="box-sizing: border-box;z-index: 1;color: rgb(249, 238, 154);">if</span> <span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">(</span><span class="" style="box-sizing: border-box;z-index: 1;">k</span><span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">(</span>a<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">,</span> b<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">,</span> c<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">)</span><span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">)</span> <span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">{</span><br style="box-sizing: border-box;"> &nbsp; &nbsp;<span class="" spellcheck="true" style="box-sizing: border-box;z-index: 1;color: rgb(120, 120, 120);">// ...</span><br style="box-sizing: border-box;"> &nbsp;<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">}</span><br style="box-sizing: border-box;"><span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">}</span></p></pre><p style="box-sizing: border-box;margin: 0px 0px 1.125em;color: rgb(32, 33, 35);">流程图形如：</p><p><br></p><figure style="box-sizing: border-box;padding: 0px;text-align: center;color: rgb(32, 33, 35);"><img data-src="http://mmbiz.qpic.cn/mmbiz_jpg/meG6Vo0Mevgz6KGEl8EZeicRyibRFscYpevpeImib1h1yowGacHvFxayHGPVowmiakYxYiaWleXaaXzvjEquju4delw/0?wx_fmt=jpeg" style="box-sizing: border-box; display: block; margin: 0px auto; width: 670px !important; height: 502.5px !important;" class="img_loading" data-ratio="0.75" data-w="1024" data-type="jpeg" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="></figure><p><br></p><p style="box-sizing: border-box;margin: 0px 0px 1.125em;color: rgb(32, 33, 35);">它通过从上到下嵌套的 if，让单个函数内的控制流不停增长。不要以为控制流增长时，复杂度只会线性增加。我们知道函数处理的是数据，而每个 if 内一般都会有对数据的处理逻辑。那么，即便在不存在嵌套的情形下，如果有 3 段这样的 if，那么根据每个 if 是否执行，数据状态就有 2 ^ 3 = 8 种。如果有 6 段，那么状态就有 2 ^ 6 = 64 种。从而在项目规模扩大时，函数的调试难度会指数级上升！这在数量级上，与《人月神话》的经验一致。</p><p style="box-sizing: border-box;margin: 0px 0px 1.125em;color: rgb(32, 33, 35);"><span style="color: rgb(61, 167, 66);"><strong>else if...else if 型</strong></span></p><p style="box-sizing: border-box;margin: 0px 0px 1.125em;color: rgb(32, 33, 35);">这个类型的代码控制流，同样是非常常见的。形如：</p><pre class="" style="box-sizing: border-box;margin: 0px 0px 1.125em;font-size: 0.875rem;overflow: auto;color: white;background: rgb(20, 20, 20) none repeat scroll 0% 0%;padding: 10px;"><p><span class="" style="box-sizing: border-box;z-index: 1;color: rgb(249, 238, 154);">function</span> demo <span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">(</span>a<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">,</span> b<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">,</span> c<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">)</span> <span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">{</span><br style="box-sizing: border-box;"> &nbsp;<span class="" style="box-sizing: border-box;z-index: 1;color: rgb(249, 238, 154);">if</span> <span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">(</span><span class="" style="box-sizing: border-box;z-index: 1;">f</span><span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">(</span>a<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">,</span> b<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">,</span> c<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">)</span><span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">)</span> <span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">{</span><br style="box-sizing: border-box;"> &nbsp; &nbsp;<span class="" style="box-sizing: border-box;z-index: 1;color: rgb(249, 238, 154);">if</span> <span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">(</span><span class="" style="box-sizing: border-box;z-index: 1;">g</span><span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">(</span>a<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">,</span> b<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">,</span> c<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">)</span><span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">)</span> <span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">{</span><br style="box-sizing: border-box;"> &nbsp; &nbsp; &nbsp;<span class="" spellcheck="true" style="box-sizing: border-box;z-index: 1;color: rgb(120, 120, 120);">// ...</span><br style="box-sizing: border-box;"> &nbsp; &nbsp;<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">}</span><br style="box-sizing: border-box;"> &nbsp; &nbsp;<span class="" spellcheck="true" style="box-sizing: border-box;z-index: 1;color: rgb(120, 120, 120);">// ...</span><br style="box-sizing: border-box;"> &nbsp; &nbsp;<span class="" style="box-sizing: border-box;z-index: 1;color: rgb(249, 238, 154);">else</span> <span class="" style="box-sizing: border-box;z-index: 1;color: rgb(249, 238, 154);">if</span> <span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">(</span><span class="" style="box-sizing: border-box;z-index: 1;">h</span><span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">(</span>a<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">,</span> b<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">,</span> c<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">)</span><span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">)</span> <span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">{</span><br style="box-sizing: border-box;"> &nbsp; &nbsp; &nbsp;<span class="" spellcheck="true" style="box-sizing: border-box;z-index: 1;color: rgb(120, 120, 120);">// ...</span><br style="box-sizing: border-box;"> &nbsp; &nbsp;<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">}</span><br style="box-sizing: border-box;"> &nbsp; &nbsp;<span class="" spellcheck="true" style="box-sizing: border-box;z-index: 1;color: rgb(120, 120, 120);">// ...</span><br style="box-sizing: border-box;"> &nbsp;<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">}</span> <span class="" style="box-sizing: border-box;z-index: 1;color: rgb(249, 238, 154);">else</span> <span class="" style="box-sizing: border-box;z-index: 1;color: rgb(249, 238, 154);">if</span> <span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">(</span><span class="" style="box-sizing: border-box;z-index: 1;">j</span><span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">(</span>a<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">,</span> b<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">,</span> c<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">)</span><span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">)</span> <span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">{</span><br style="box-sizing: border-box;"> &nbsp; &nbsp;<span class="" spellcheck="true" style="box-sizing: border-box;z-index: 1;color: rgb(120, 120, 120);">// ...</span><br style="box-sizing: border-box;"> &nbsp;<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">}</span> <span class="" style="box-sizing: border-box;z-index: 1;color: rgb(249, 238, 154);">else</span> <span class="" style="box-sizing: border-box;z-index: 1;color: rgb(249, 238, 154);">if</span> <span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">(</span><span class="" style="box-sizing: border-box;z-index: 1;">k</span><span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">(</span>a<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">,</span> b<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">,</span> c<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">)</span><span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">)</span> <span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">{</span><br style="box-sizing: border-box;"> &nbsp; &nbsp;<span class="" spellcheck="true" style="box-sizing: border-box;z-index: 1;color: rgb(120, 120, 120);">// ...</span><br style="box-sizing: border-box;"> &nbsp;<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">}</span><br style="box-sizing: border-box;"><span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">}</span></p></pre><p style="box-sizing: border-box;margin: 0px 0px 1.125em;color: rgb(32, 33, 35);">流程图形如：</p><p><br></p><figure style="box-sizing: border-box;padding: 0px;text-align: center;color: rgb(32, 33, 35);"><img data-src="http://mmbiz.qpic.cn/mmbiz_jpg/meG6Vo0Mevgz6KGEl8EZeicRyibRFscYpe6jlAGbjuc9tibUtZHRv1XxX1RrMmlWtNmuDtyiaBFtz2UHmX9SiajCaZA/0?wx_fmt=jpeg" style="box-sizing: border-box; display: block; margin: 0px auto; width: 670px !important; height: 502.5px !important;" class="img_loading" data-ratio="0.75" data-w="1024" data-type="jpeg" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="></figure><p><br></p><p style="box-sizing: border-box;margin: 0px 0px 1.125em;color: rgb(32, 33, 35);">else if 最终只会走入其中的某一个分支，因此并不会出现上面组合爆炸的情形。但是，在深度嵌套时，复杂度同样不低。假设嵌套 3 层，每层存在 3 个 else if，那么这时就会出现 3 ^ 3 = 27 个出口。如果每种出口对应一种处理数据的方式，那么一个函数内封装这么多逻辑，也显然是违背单一职责原则的。并且，上述两种类型可以无缝组合，进一步增加复杂度，降低可读性。</p><p style="box-sizing: border-box;margin: 0px 0px 1.125em;color: rgb(32, 33, 35);">但为什么在这个有了各种先进的框架和类库的时代，还是经常会出现这样的代码呢？个人的观点是，复用的模块确实能够让我们少写【模板代码】，但业务本身无论再怎么封装，也是需要开发者去编写逻辑的。而即便是简单的 if else，也能让控制流的复杂度指数级上升。从这个角度上说，如果没有基本的编程素养，不论速成掌握再优秀的框架与类库，同样会把项目写得一团糟。</p><p style="box-sizing: border-box;margin: 0px 0px 1.125em;color: rgb(32, 33, 35);"><span style="color: rgb(61, 167, 66);"><strong>重构策略</strong></span></p><p style="box-sizing: border-box;margin: 0px 0px 1.125em;color: rgb(32, 33, 35);">上文中，我们已经讨论了面条代码的两种类型，并量化地论证了它们是如何让控制流复杂度指数级激增的。然而，在现代的编程语言中，这种复杂度其实是完全可控的。下面分几种情形，列出改善面条代码的编程技巧。</p><p style="box-sizing: border-box;margin: 0px 0px 1.125em;color: rgb(32, 33, 35);"><span style="color: rgb(0, 122, 170);">基本情形</span></p><p style="box-sizing: border-box;margin: 0px 0px 1.125em;color: rgb(32, 33, 35);">对看起来复杂度增长最快的 if...if 型面条代码，通过基本的函数即可将其拆分。下图中每个绿框代表拆分出的一个新函数：</p><p><br></p><figure style="box-sizing: border-box;padding: 0px;text-align: center;color: rgb(32, 33, 35);"><img data-src="http://mmbiz.qpic.cn/mmbiz_jpg/meG6Vo0Mevgz6KGEl8EZeicRyibRFscYpeUyL6F5iboKoib11Ya8ELRsN0scnz64OpqxJUH9HUSBjsQRphPOk2hdbg/0?wx_fmt=jpeg" style="box-sizing: border-box; display: block; margin: 0px auto; width: 670px !important; height: 502.5px !important;" class="img_loading" data-ratio="0.75" data-w="1024" data-type="jpeg" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="><br></figure><p><br></p><p style="box-sizing: border-box;margin: 0px 0px 1.125em;color: rgb(32, 33, 35);">由于现代编程语言摒弃了 goto，因此不论控制流再复杂，函数体内代码的执行顺序也都是从上而下的。因此，我们完全有能力在不改变控制流逻辑的前提下，将一个单体的大函数，自上而下拆逐步分为多个小函数，而后逐个调用之。这是有经验的同学经常使用的技巧，具体代码实现在此不做赘述了。</p><p style="box-sizing: border-box;margin: 0px 0px 1.125em;color: rgb(32, 33, 35);">需要注意的是，这种做法中所谓的不改变控制流逻辑，意味着改动并不需要更改业务逻辑的执行方式，只是简单地【把代码移出去，然后用函数包一层】而已。有些同学可能会认为这种方式治标不治本，不过是把一大段面条切成了几小段，并没有本质的区别。</p><p style="box-sizing: border-box;margin: 0px 0px 1.125em;color: rgb(32, 33, 35);">然而真的是这样吗？通过这种方式，我们能够把一个有 64 种状态的大函数，拆分为 6 个只返回 2 种不同状态的小函数，以及一个逐个调用它们的 main 函数。这样一来，每个函数复杂度的增长速度，就从指数级降低到了线性级。</p><p style="box-sizing: border-box;margin: 0px 0px 1.125em;color: rgb(32, 33, 35);">这样一来，我们就解决了 if...if 类型面条代码了，那么对于 else if...else if 类型的呢？</p><p style="box-sizing: border-box;margin: 0px 0px 1.125em;color: rgb(32, 33, 35);"><span style="color: rgb(0, 122, 170);">查找表</span></p><p style="box-sizing: border-box;margin: 0px 0px 1.125em;color: rgb(32, 33, 35);">对于 else if...else if 类型的面条代码，一种最简单的重构策略是使用所谓的查找表。它通过键值对的形式来封装每个 else if 中的逻辑：</p><pre class="" style="box-sizing: border-box;margin: 0px 0px 1.125em;font-size: 0.875rem;overflow: auto;color: white;background: rgb(20, 20, 20) none repeat scroll 0% 0%;padding: 10px;"><p><span class="" style="box-sizing: border-box;z-index: 1;color: rgb(249, 238, 154);">const</span> rules <span class="" style="box-sizing: border-box;z-index: 1;color: rgb(145, 158, 107);">=</span> <span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">{</span><br style="box-sizing: border-box;"> &nbsp;x<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">:</span> <span class="" style="box-sizing: border-box;z-index: 1;color: rgb(249, 238, 154);">function</span> <span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">(</span>a<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">,</span> b<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">,</span> c<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">)</span> <span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">{</span> <span class="" spellcheck="true" style="box-sizing: border-box;z-index: 1;color: rgb(120, 120, 120);">/* ... */</span> <span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">}</span><span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">,</span><br style="box-sizing: border-box;"> &nbsp;y<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">:</span> <span class="" style="box-sizing: border-box;z-index: 1;color: rgb(249, 238, 154);">function</span> <span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">(</span>a<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">,</span> b<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">,</span> c<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">)</span> <span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">{</span> <span class="" spellcheck="true" style="box-sizing: border-box;z-index: 1;color: rgb(120, 120, 120);">/* ... */</span> <span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">}</span><span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">,</span><br style="box-sizing: border-box;"> &nbsp;z<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">:</span> <span class="" style="box-sizing: border-box;z-index: 1;color: rgb(249, 238, 154);">function</span> <span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">(</span>a<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">,</span> b<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">,</span> c<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">)</span> <span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">{</span> <span class="" spellcheck="true" style="box-sizing: border-box;z-index: 1;color: rgb(120, 120, 120);">/* ... */</span> <span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">}</span><br style="box-sizing: border-box;"><span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">}</span><br style="box-sizing: border-box;"><span class="" style="box-sizing: border-box;z-index: 1;color: rgb(249, 238, 154);">function</span> demo <span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">(</span>a<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">,</span> b<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">,</span> c<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">)</span> <span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">{</span><br style="box-sizing: border-box;"> &nbsp;<span class="" style="box-sizing: border-box;z-index: 1;color: rgb(249, 238, 154);">const</span> action <span class="" style="box-sizing: border-box;z-index: 1;color: rgb(145, 158, 107);">=</span> <span class="" style="box-sizing: border-box;z-index: 1;">determineAction</span><span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">(</span>a<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">,</span> b<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">,</span> c<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">)</span><br style="box-sizing: border-box;"> &nbsp;<span class="" style="box-sizing: border-box;z-index: 1;color: rgb(249, 238, 154);">return</span> rules<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">[</span>action<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">]</span><span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">(</span>a<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">,</span> b<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">,</span> c<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">)</span><br style="box-sizing: border-box;"><span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">}</span></p></pre><p style="box-sizing: border-box;margin: 0px 0px 1.125em;color: rgb(32, 33, 35);">每个 else if 中的逻辑都被改写为一个独立的函数，这时我们就能够将流程按照如下所示的方式拆分了：</p><p><br></p><figure style="box-sizing: border-box;padding: 0px;text-align: center;color: rgb(32, 33, 35);"><img data-src="http://mmbiz.qpic.cn/mmbiz_jpg/meG6Vo0Mevgz6KGEl8EZeicRyibRFscYpeLFFXsjPibtfz5Xw3iaQYQm0DlLIJel2p6Nlk7UYFKOl8NuONhYallVTA/0?wx_fmt=jpeg" style="box-sizing: border-box; display: block; margin: 0px auto; width: 670px !important; height: 502.5px !important;" class="img_loading" data-ratio="0.75" data-w="1024" data-type="jpeg" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="></figure><p><br></p><p style="box-sizing: border-box;margin: 0px 0px 1.125em;color: rgb(32, 33, 35);">对于先天支持反射的脚本语言来说，这也算是较为 trivial 的技巧了。但对于更复杂的 else if 条件，这种方式会重新把控制流的复杂度集中到处理【该走哪个分支】问题的 determineAction 中。有没有更好的处理方式呢？</p><p style="box-sizing: border-box;margin: 0px 0px 1.125em;color: rgb(32, 33, 35);"><span style="color: rgb(0, 122, 170);">职责链模式</span></p><p style="box-sizing: border-box;margin: 0px 0px 1.125em;color: rgb(32, 33, 35);">在上文中，查找表是用键值对实现的，对于每个分支都是 else if (x === 'foo') 这样简单判断的情形时，'foo' 就可以作为重构后集合的键了。但如果每个 else if 分支都包含了复杂的条件判断，且其对执行的先后顺序有所要求，那么我们可以用职责链模式来更好地重构这样的逻辑。</p><p style="box-sizing: border-box;margin: 0px 0px 1.125em;color: rgb(32, 33, 35);">对 else if 而言，注意到每个分支其实是从上到下依次判断，最后仅走入其中一个的。这就意味着，我们可以通过存储【判定规则】的数组，来实现这种行为。如果规则匹配，那么就执行这条规则对应的分支。我们把这样的数组称为【职责链】，这种模式下的执行流程如下图：</p><p><br></p><figure style="box-sizing: border-box;padding: 0px;text-align: center;color: rgb(32, 33, 35);"><img data-src="http://mmbiz.qpic.cn/mmbiz_jpg/meG6Vo0Mevgz6KGEl8EZeicRyibRFscYpe8jaKaLBib2II3hHCibLb0U4vQtfRWfF1YoT3ICsst3LREpjtbibkZTQcg/0?wx_fmt=jpeg" style="box-sizing: border-box; display: block; margin: 0px auto; width: 670px !important; height: 502.5px !important;" class="img_loading" data-ratio="0.75" data-w="1024" data-type="jpeg" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="></figure><p><br></p><p style="box-sizing: border-box;margin: 0px 0px 1.125em;color: rgb(32, 33, 35);">在代码实现上，我们可以通过一个职责链数组来定义与 else if 完全等效的规则：</p><pre class="" style="box-sizing: border-box;margin: 0px 0px 1.125em;font-size: 0.875rem;overflow: auto;color: white;background: rgb(20, 20, 20) none repeat scroll 0% 0%;padding: 10px;"><p><span class="" style="box-sizing: border-box;z-index: 1;color: rgb(249, 238, 154);">const</span> rules <span class="" style="box-sizing: border-box;z-index: 1;color: rgb(145, 158, 107);">=</span> <span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">[</span><br style="box-sizing: border-box;"> &nbsp;<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">{</span><br style="box-sizing: border-box;"> &nbsp; &nbsp;match<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">:</span> <span class="" style="box-sizing: border-box;z-index: 1;color: rgb(249, 238, 154);">function</span> <span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">(</span>a<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">,</span> b<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">,</span> c<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">)</span> <span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">{</span> <span class="" spellcheck="true" style="box-sizing: border-box;z-index: 1;color: rgb(120, 120, 120);">/* ... */</span> <span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">}</span><span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">,</span><br style="box-sizing: border-box;"> &nbsp; &nbsp;action<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">:</span> <span class="" style="box-sizing: border-box;z-index: 1;color: rgb(249, 238, 154);">function</span> <span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">(</span>a<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">,</span> b<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">,</span> c<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">)</span> <span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">{</span> <span class="" spellcheck="true" style="box-sizing: border-box;z-index: 1;color: rgb(120, 120, 120);">/* ... */</span> <span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">}</span><br style="box-sizing: border-box;"> &nbsp;<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">}</span><span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">,</span><br style="box-sizing: border-box;"> &nbsp;<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">{</span><br style="box-sizing: border-box;"> &nbsp; &nbsp;match<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">:</span> <span class="" style="box-sizing: border-box;z-index: 1;color: rgb(249, 238, 154);">function</span> <span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">(</span>a<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">,</span> b<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">,</span> c<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">)</span> <span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">{</span> <span class="" spellcheck="true" style="box-sizing: border-box;z-index: 1;color: rgb(120, 120, 120);">/* ... */</span> <span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">}</span><span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">,</span><br style="box-sizing: border-box;"> &nbsp; &nbsp;action<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">:</span> <span class="" style="box-sizing: border-box;z-index: 1;color: rgb(249, 238, 154);">function</span> <span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">(</span>a<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">,</span> b<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">,</span> c<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">)</span> <span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">{</span> <span class="" spellcheck="true" style="box-sizing: border-box;z-index: 1;color: rgb(120, 120, 120);">/* ... */</span> <span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">}</span><br style="box-sizing: border-box;"> &nbsp;<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">}</span><span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">,</span><br style="box-sizing: border-box;"> &nbsp;<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">{</span><br style="box-sizing: border-box;"> &nbsp; &nbsp;match<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">:</span> <span class="" style="box-sizing: border-box;z-index: 1;color: rgb(249, 238, 154);">function</span> <span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">(</span>a<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">,</span> b<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">,</span> c<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">)</span> <span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">{</span> <span class="" spellcheck="true" style="box-sizing: border-box;z-index: 1;color: rgb(120, 120, 120);">/* ... */</span> <span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">}</span><span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">,</span><br style="box-sizing: border-box;"> &nbsp; &nbsp;action<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">:</span> <span class="" style="box-sizing: border-box;z-index: 1;color: rgb(249, 238, 154);">function</span> <span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">(</span>a<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">,</span> b<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">,</span> c<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">)</span> <span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">{</span> <span class="" spellcheck="true" style="box-sizing: border-box;z-index: 1;color: rgb(120, 120, 120);">/* ... */</span> <span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">}</span><br style="box-sizing: border-box;"> &nbsp;<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">}</span><br style="box-sizing: border-box;"> &nbsp;<span class="" spellcheck="true" style="box-sizing: border-box;z-index: 1;color: rgb(120, 120, 120);">// ...</span><br style="box-sizing: border-box;"><span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">]</span></p></pre><p style="box-sizing: border-box;margin: 0px 0px 1.125em;color: rgb(32, 33, 35);">rules 中的每一项都具有 match 与 action 属性。这时我们可以将原有函数的 else if 改写对职责链数组的遍历：</p><pre class="" style="box-sizing: border-box;margin: 0px 0px 1.125em;font-size: 0.875rem;overflow: auto;color: white;background: rgb(20, 20, 20) none repeat scroll 0% 0%;padding: 10px;"><p><span class="" style="box-sizing: border-box;z-index: 1;color: rgb(249, 238, 154);">function</span> demo <span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">(</span>a<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">,</span> b<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">,</span> c<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">)</span> <span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">{</span><br style="box-sizing: border-box;"> &nbsp;<span class="" style="box-sizing: border-box;z-index: 1;color: rgb(249, 238, 154);">for</span> <span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">(</span><span class="" style="box-sizing: border-box;z-index: 1;color: rgb(249, 238, 154);">let</span> i <span class="" style="box-sizing: border-box;z-index: 1;color: rgb(145, 158, 107);">=</span> <span class="" style="box-sizing: border-box;z-index: 1;color: rgb(207, 105, 74);">0</span><span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">;</span> i <span class="" style="box-sizing: border-box;z-index: 1;color: rgb(145, 158, 107);">&lt;</span> rules<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">.</span>length<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">;</span> i<span class="" style="box-sizing: border-box;z-index: 1;color: rgb(145, 158, 107);">++</span><span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">)</span> <span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">{</span><br style="box-sizing: border-box;"> &nbsp; &nbsp;<span class="" style="box-sizing: border-box;z-index: 1;color: rgb(249, 238, 154);">if</span> <span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">(</span>rules<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">[</span>i<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">]</span><span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">.</span><span class="" style="box-sizing: border-box;z-index: 1;">match</span><span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">(</span>a<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">,</span> b<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">,</span> c<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">)</span><span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">)</span> <span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">{</span><br style="box-sizing: border-box;"> &nbsp; &nbsp; &nbsp;<span class="" style="box-sizing: border-box;z-index: 1;color: rgb(249, 238, 154);">return</span> rules<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">[</span>i<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">]</span><span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">.</span><span class="" style="box-sizing: border-box;z-index: 1;">action</span><span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">(</span>a<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">,</span> b<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">,</span> c<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">)</span><br style="box-sizing: border-box;"> &nbsp; &nbsp;<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">}</span><br style="box-sizing: border-box;"> &nbsp;<span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">}</span><br style="box-sizing: border-box;"><span class="" style="box-sizing: border-box;z-index: 1;opacity: 0.7;">}</span></p></pre><p style="box-sizing: border-box;margin: 0px 0px 1.125em;color: rgb(32, 33, 35);">这时每个职责一旦匹配，原函数就会直接返回，这也完全符合 else if 的语义。通过这种方式，我们就实现了对单体复杂 else if 逻辑的拆分了。</p><p style="box-sizing: border-box;margin: 0px 0px 1.125em;color: rgb(32, 33, 35);"><span style="color: rgb(61, 167, 66);"><strong>总结</strong></span></p><p style="box-sizing: border-box;margin: 0px 0px 1.125em;color: rgb(32, 33, 35);">面条代码其实容易出现在不加思考的【糙快猛】式开发中。很多简单粗暴地【在这里加个 if，在那里多个 return】的 bug 修复方式，再加上注释的匮乏，很容易让代码可读性越来越差，复杂度越来越高。</p><p style="box-sizing: border-box;margin: 0px 0px 1.125em;color: rgb(32, 33, 35);">但解决这个问题的几种方案都并不复杂。这些示例之所以简单，本质上是因为高级编程语言强大的表达能力已经能够不依赖于各种模式的模板代码，为需求提供直接的语义支持，而无需套用各种设计模式的八股文。</p><p style="box-sizing: border-box;margin: 0px 0px 1.125em;color: rgb(32, 33, 35);">当然，你可以用模式来概括一些降低业务逻辑复杂度的技巧，但如果生搬硬套地记忆并使用模式，同样可能会走进过度设计的歧途。在实现常见业务功能时，掌握好编程语言，梳理好需求，用最简单的代码将其实现，就已经是最优解了。</p><p>最后，为你推荐：</p><p><a href="http://mp.weixin.qq.com/s?__biz=MjM5MTA1MjAxMQ==&amp;mid=2651220860&amp;idx=1&amp;sn=ea68514aa7c515dcbcbb3fc89c7b5695&amp;scene=21#wechat_redirect" target="_blank">【第590期】解开面条代码: 怎样书写可维护JavaScript</a><br></p><p><br></p><p>关于本文</p><p>作者：@ewind</p><p>原文：http://ewind.us/2017/refactor-if-else/</p><p><br></p><p><img data-s="300,640" data-type="jpeg" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/meG6Vo0Mevg6SJZhosLG5upf1s7QkqIchxVRwInjJqMVEfLR7JAT0FGEMXqHic2iaosziclI4gE5Y3icqSZuUiba3Gg/0?wx_fmt=jpeg" class="img_loading" data-ratio="0.4166666666666667" data-w="720" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" style="width: 670px !important; height: 279.167px !important;"></p>
                        </div>
                        <script nonce="1800196177" type="text/javascript">
                            var first_sceen__time = (+new Date());

                            if ("" == 1 && document.getElementById('js_content')) {
                                document.getElementById('js_content').addEventListener("selectstart",function(e){ e.preventDefault(); });
                            }


                            (function(){
                                if (navigator.userAgent.indexOf("WindowsWechat") != -1){
                                    var link = document.createElement('link');
                                    var head = document.getElementsByTagName('head')[0];
                                    link.rel = 'stylesheet';
                                    link.type = 'text/css';
                                    link.href = "//res.wx.qq.com/mmbizwap/zh_CN/htmledition/style/page/appmsg/page_mp_article_improve_winwx31619e.css";
                                    head.appendChild(link);
                                }
                            })();
                        </script>



                        <div class="ct_mpda_wrp" id="js_sponsor_ad_area" style="display:none;"></div>


                        <div class="reward_area tc" id="js_preview_reward" style="display:none;">
                            <p id="js_preview_reward_wording" class="tips_global reward_tips" style="display:none;"></p>
                            <p>
                                <a class="reward_access" id="js_preview_reward_link" href="##">赞赏</a>
                            </p>
                        </div>
                        <div class="reward_qrcode_area reward_area tc" id="js_preview_reward_qrcode" style="display:none;">
                            <p class="tips_global">长按二维码向我转账</p>
                            <p id="js_preview_reward_ios_wording" class="reward_tips" style="display:none;"></p>
                            <span class="reward_qrcode_img_wrp"><img class="reward_qrcode_img" src="//res.wx.qq.com/mmbizwap/zh_CN/htmledition/images/pic/appmsg/pic_reward_qrcode.2x3534dd.png"></span>
                            <p class="tips_global">受苹果公司新规定影响，微信 iOS 版的赞赏功能被关闭，可通过二维码转账支持公众号。</p>
                        </div>
                    </div>

                    <div class="rich_media_tool" id="js_toobar3">
                        <a class="media_tool_meta meta_primary" id="js_view_source" href="##">阅读原文</a>
                        <div id="js_read_area3" class="media_tool_meta tips_global meta_primary" style="display:none;">阅读 <span id="readNum3"></span></div>

                        <span style="display:none;" class="media_tool_meta meta_primary tips_global meta_praise" id="like3">
                    <i class="icon_praise_gray"></i><span class="praise_num" id="likeNum3"></span>
                </span>

                        <a id="js_report_article3" style="display:none;" class="media_tool_meta tips_global meta_extra" href="##">投诉</a>

                    </div>


                </div>

                <div class="rich_media_area_primary sougou" id="sg_tj" style="display:none"></div>


                <div class="rich_media_area_extra">


                    <div class="mpda_bottom_container" id="js_bottom_ad_area" style="display: none;"></div>

                    <div id="js_iframetest" style="display:none;"></div>

                    <div class="rich_media_extra" id="js_cmt_area" style="display:none">
                    </div>
                </div>


                <div id="js_pc_qr_code" class="qr_code_pc_outer" style="display: block;">
                    <div class="qr_code_pc_inner">
                        <div class="qr_code_pc">
                            <img id="js_pc_qr_code_img" class="qr_code_pc_img" src="/mp/qrcode?scene=10000004&amp;size=102&amp;__biz=MjM5MTA1MjAxMQ==&amp;mid=2651227093&amp;idx=1&amp;sn=dbeae0d2ffbfd9e29189bdb2f8f45238&amp;send_time=">
                            <p>微信扫一扫<br>关注该公众号</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
<script>
    var category = [];
    $(function () {

        $.each($(".category-list"),function (i, v) {
            category.push(v.innerText);
        })
    })
    function add_category() {
        var name = $(".cat_name").val().trim();
        var name_bl = false;
        if(name.length > 0){
            name_bl = category.indexOf(name) >= 0 ? false : true;
            if(!name_bl){
                $(".cat_name").showTips("分类名已存在")
            }
        }else{
            $(".cat_name").showTips("请填写分类名")
        }

        return name_bl;
    }
</script>
</body>
</html>